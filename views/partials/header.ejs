<header class="header">
   <a class="header_home" href="/"> Bookworms </a>
   <nav class="header_menu">
      <ul>
         <li><a href="/cart">Cart <svg width="800px" height="800px" class="svg-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6.29977 5H21L19 12H7.37671M20 16H8L6 3H3M9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20C7 19.4477 7.44772 19 8 19C8.55228 19 9 19.4477 9 20ZM20 20C20 20.5523 19.5523 21 19 21C18.4477 21 18 20.5523 18 20C18 19.4477 18.4477 19 19 19C19.5523 19 20 19.4477 20 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg></a></li>
         <li><a href="/login">Login</a></li>
         <li><a href="/register">Register</a></li>
      </ul>
   </nav>
</header>
<script>
   document.addEventListener('DOMContentLoaded', async () => {
      try 
      {
         const response = await fetch('/api/checkLogedState', {
            method: 'GET',
            headers: {
               'Content-Type': 'application/json'
            }
         });

         if (response.status === 200) {
            const data = await response.json();
            const headerMenu = document.querySelector('.header_menu');
            headerMenu.innerHTML = `
               <ul>
                  <li>
                     <a href="/cart">Cart 
                        <svg width="800px" height="800px" class="svg-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path d="M6.29977 5H21L19 12H7.37671M20 16H8L6 3H3M9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20C7 19.4477 7.44772 19 8 19C8.55228 19 9 19.4477 9 20ZM20 20C20 20.5523 19.5523 21 19 21C18.4477 21 18 20.5523 18 20C18 19.4477 18.4477 19 19 19C19.5523 19 20 19.4477 20 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                     </a>
                  </li>
                  <li><a href="/profile">Profile</a></li>
                  <li><a href="" id="logout">Logout</a></li>
               </ul>
            `;

            const logoutButton = document.getElementById('logout');
            logoutButton.addEventListener('click', async () => {
               try 
               {
                  const response = await fetch('/api/logout', {
                     method: 'POST',
                     headers: {
                        'Content-Type': 'application/json'
                     }
                  });

                  if (response.status === 200) 
                  {
                     window.location.href = '/';
                  } 
                  else 
                  {
                     console.error('Error logging out');
                  }
               } 
               catch (error) 
               {
                  console.error('Error logging out:', error);
               }
            });
         } 
         else 
         {
            console.log('Not logged in');
         }
      } 
      catch (error) 
      {
         console.error('Error fetching logged state:', error);
      }
   });
</script>